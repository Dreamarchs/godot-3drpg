[gd_scene load_steps=15 format=3 uid="uid://lw8po7l0fp78"]

[ext_resource type="Script" uid="uid://qmuprmmgo0pv" path="res://Player/player.gd" id="1_l8h54"]
[ext_resource type="Script" uid="uid://cyaec20676p36" path="res://Player/smooth_camera_arm.gd" id="2_4ntmi"]
[ext_resource type="PackedScene" uid="uid://gu3kod7h4spy" path="res://Player/health_component.tscn" id="2_k53q1"]
[ext_resource type="Script" uid="uid://crd7xu74vfjt7" path="res://Resources/character_stats.gd" id="2_od3ui"]
[ext_resource type="PackedScene" uid="uid://vx08dyux7ogm" path="res://Player/rig.tscn" id="3_btcbx"]
[ext_resource type="Script" uid="uid://dff13cp6248da" path="res://Player/attack_cast.gd" id="4_gwnis"]
[ext_resource type="PackedScene" uid="uid://co0f73n85y2j0" path="res://area_attack.tscn" id="6_fhl08"]
[ext_resource type="PackedScene" uid="uid://d23t5a7qhr8gg" path="res://dash.tscn" id="7_vtle1"]
[ext_resource type="Script" uid="uid://c1sg3758gf647" path="res://Player/interaction_cast.gd" id="8_x3vf3"]
[ext_resource type="PackedScene" uid="uid://wmuxawrpkyd2" path="res://UserInterface/user_interface.tscn" id="9_00tjw"]

[sub_resource type="Resource" id="Resource_00tjw"]
script = ExtResource("2_od3ui")
metadata/_custom_type_script = "uid://crd7xu74vfjt7"

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_yoj86"]

[sub_resource type="SeparationRayShape3D" id="SeparationRayShape3D_l8h54"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_00tjw"]

[node name="Player" type="CharacterBody3D" groups=["Player"]]
collision_layer = 5
script = ExtResource("1_l8h54")
stats = SubResource("Resource_00tjw")

[node name="HealthComponent" parent="." node_paths=PackedStringArray("body") instance=ExtResource("2_k53q1")]
body = NodePath("..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_yoj86")

[node name="SmoothCameraArm" type="SpringArm3D" parent="." node_paths=PackedStringArray("target")]
transform = Transform3D(1, 0, 0, 0, 0.906308, 0.422618, 0, -0.422618, 0.906308, 0, 0, 0)
shape = SubResource("SeparationRayShape3D_l8h54")
spring_length = 4.0
script = ExtResource("2_4ntmi")
target = NodePath("../HorizontalPivot/VerticalPivot")

[node name="Camera3D" type="Camera3D" parent="SmoothCameraArm"]

[node name="HorizontalPivot" type="Node3D" parent="."]

[node name="VerticalPivot" type="Node3D" parent="HorizontalPivot"]

[node name="RigPivot" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)

[node name="CharacterRig" parent="RigPivot" groups=["PlayerRig"] instance=ExtResource("3_btcbx")]

[node name="Skeleton3D" parent="RigPivot/CharacterRig/Rig/GameRig" index="0"]
bones/0/position = Vector3(0.026031852, 0.8957738, -0.019433863)
bones/0/rotation = Quaternion(0.14089216, 1.1802016e-07, 1.6795651e-08, 0.990025)
bones/1/rotation = Quaternion(-0.051688593, 0.00027618717, 0.0033069442, 0.99865776)
bones/2/position = Vector3(1.8993356e-09, 0.1437566, 5.8510388e-09)
bones/2/rotation = Quaternion(0.01745258, -0.0032952793, -0.026847541, 0.9994818)
bones/3/position = Vector3(1.5960113e-09, 0.1915473, -1.3038009e-08)
bones/3/rotation = Quaternion(-0.16964553, -0.010018475, 0.052023333, 0.9840801)
bones/4/position = Vector3(-3.6189498e-09, 0.08759608, -2.020585e-09)
bones/4/rotation = Quaternion(0.3448947, -0.001665198, -0.07524923, 0.9356188)
bones/5/rotation = Quaternion(-0.09485659, -2.860405e-09, -6.256618e-08, 0.995491)
bones/6/rotation = Quaternion(-0.17939384, 0.0202298, 0.045337405, 0.9825239)
bones/7/position = Vector3(0.026031824, 0.8957737, -0.019433768)
bones/7/rotation = Quaternion(-0.078286715, -0.74519205, -0.39443004, 0.5319634)
bones/8/position = Vector3(0.026031809, 0.8957737, -0.019433832)
bones/8/rotation = Quaternion(-0.078286655, 0.74519205, 0.39442998, 0.5319634)
bones/9/position = Vector3(0.15717551, 0.96152085, -0.0043888297)
bones/9/rotation = Quaternion(0.9775078, -0.018253611, -0.029487735, 0.20802826)
bones/10/position = Vector3(-1.1429672e-08, 0.26578248, -8.652471e-09)
bones/10/rotation = Quaternion(-1.34782985e-08, -0.006340666, 1.1268048e-08, 0.9999799)
bones/11/position = Vector3(-7.352991e-09, 0.26578245, 9.887333e-09)
bones/11/rotation = Quaternion(0.4062421, -0.0060207522, 0.003744215, 0.913738)
bones/12/position = Vector3(9.816164e-09, 0.2257979, 2.7883894e-08)
bones/12/rotation = Quaternion(-1.0467739e-08, 0.008629464, 2.8245413e-08, 0.99996287)
bones/13/position = Vector3(-1.5521485e-08, 0.22579789, -1.2997578e-08)
bones/13/rotation = Quaternion(-0.71946317, 0.033436503, -0.019870162, 0.6934407)
bones/14/position = Vector3(-1.385589e-08, 0.13987769, 9.075052e-10)
bones/14/rotation = Quaternion(-0.00010031249, 0.9674615, -0.2530183, -0.00038247704)
bones/15/position = Vector3(-0.10511183, 0.961521, -0.004388826)
bones/15/rotation = Quaternion(0.9940697, -0.026784625, 0.02913561, 0.1012882)
bones/16/position = Vector3(-6.771491e-09, 0.2638901, -2.5221237e-08)
bones/16/rotation = Quaternion(-3.0060093e-08, -0.0004171499, -3.6833214e-08, 1)
bones/17/position = Vector3(9.440262e-09, 0.26389024, -7.913105e-09)
bones/17/rotation = Quaternion(0.5582951, 3.587935e-05, 0.0019433601, 0.82964027)
bones/18/position = Vector3(6.23065e-09, 0.22382146, 8.430723e-10)
bones/18/rotation = Quaternion(-4.9146665e-09, -0.012291275, 2.0051177e-08, 0.9999245)
bones/19/position = Vector3(-6.2365895e-09, 0.22382142, 1.037734e-08)
bones/19/rotation = Quaternion(-0.62270427, -0.034467075, -0.0023044809, 0.7816945)
bones/20/position = Vector3(-3.822187e-11, 0.1398778, -8.104378e-09)
bones/20/rotation = Quaternion(-9.955496e-05, 0.9674598, -0.25302485, -0.00038308025)
bones/21/position = Vector3(0.049810335, 1.4068971, 0.09936894)
bones/21/rotation = Quaternion(-0.44508335, -0.2768851, -0.4033731, 0.75001717)
bones/22/position = Vector3(0.21420516, 1.4567362, 0.047250044)
bones/22/rotation = Quaternion(-0.046983365, -0.10595422, 0.9781742, -0.17245768)
bones/23/position = Vector3(-5.0752647e-09, 0.14231999, -5.7296802e-08)
bones/23/rotation = Quaternion(5.978006e-08, -0.04189887, 3.2091718e-09, 0.99912184)
bones/24/position = Vector3(-5.716928e-08, 0.14232019, 1.5145016e-08)
bones/24/rotation = Quaternion(0.5126331, -0.05083948, -0.14934105, 0.84399045)
bones/25/position = Vector3(-2.4927747e-08, 0.12591866, 1.4627856e-08)
bones/25/rotation = Quaternion(-4.2246477e-08, 0.0072386465, 1.09975264e-08, 0.9999738)
bones/26/position = Vector3(2.0004482e-08, 0.12591857, -3.0393918e-09)
bones/26/rotation = Quaternion(0.022150066, 0.007032253, -0.16279282, 0.98638666)
bones/28/rotation = Quaternion(0.70258325, -0.00093979, -0.001335505, 0.7115997)
bones/29/rotation = Quaternion(0.74112064, 0.0021826618, 0.0026539827, 0.6713631)
bones/30/rotation = Quaternion(0.32526952, 0.8900551, 0.2959771, -0.1199969)
bones/31/rotation = Quaternion(0.51488215, -0.11414927, 0.11448255, 0.8418789)
bones/32/rotation = Quaternion(0.5920035, -0.03813503, -0.09069874, 0.79990715)
bones/34/position = Vector3(-0.003169373, 0.09872067, 0.014791745)
bones/34/rotation = Quaternion(-0.06747008, 0.7184456, 0.06639644, 0.68911195)
bones/35/rotation = Quaternion(0.58080345, -0.000891879, -0.001497506, 0.8140419)
bones/36/rotation = Quaternion(0.682777, 0.0017451888, 0.0025661471, 0.73062027)
bones/37/rotation = Quaternion(-0.0042650807, 0.73671365, 0.03947847, 0.675038)
bones/38/position = Vector3(-0.006229548, 0.09264146, -0.023634413)
bones/39/rotation = Quaternion(0.6300386, 0.0015196431, 0.002379072, 0.77655876)
bones/40/rotation = Quaternion(0.65264326, -0.0030812381, -0.004210616, 0.75764745)
bones/42/position = Vector3(-0.0071537, 0.067985795, -0.048198394)
bones/42/rotation = Quaternion(-0.120912984, 0.799109, 0.03589211, 0.5878068)
bones/43/rotation = Quaternion(0.49869275, -0.020270592, -0.025695244, 0.8661608)
bones/44/rotation = Quaternion(0.71538454, 0.03530609, 0.05731428, 0.6954808)
bones/45/rotation = Quaternion(-0.1290595, 0.72893643, -0.025025949, 0.6718401)
bones/46/position = Vector3(0.0134493215, 1.4049735, 0.09836103)
bones/46/rotation = Quaternion(-0.47152922, 0.2279719, 0.42922142, 0.73583835)
bones/47/position = Vector3(-0.15119474, 1.4374909, 0.033406734)
bones/47/rotation = Quaternion(0.05374454, -0.05659184, 0.9830076, 0.16614723)
bones/48/position = Vector3(2.5262992e-09, 0.14342514, 4.365812e-08)
bones/48/rotation = Quaternion(-6.2982465e-08, 0.0824877, 1.5801632e-08, 0.9965921)
bones/49/position = Vector3(1.7104377e-08, 0.14342535, 2.3201816e-08)
bones/49/rotation = Quaternion(0.5513424, 0.09492112, 0.15371872, 0.8144827)
bones/50/position = Vector3(-9.31708e-08, 0.12707181, 3.673123e-08)
bones/50/rotation = Quaternion(-1.6119719e-08, -0.0069979555, -1.2173554e-07, 0.99997556)
bones/51/position = Vector3(1.3288764e-07, 0.12707193, 7.527603e-09)
bones/51/rotation = Quaternion(-0.091954544, -0.0067612636, -0.0083291475, 0.9957054)
bones/52/rotation = Quaternion(-0.25630006, 0.85585946, 0.029918563, -0.448241)
bones/53/rotation = Quaternion(0.694912, 0.1071447, -0.10354833, 0.7034879)
bones/54/rotation = Quaternion(0.7411205, -0.0021827077, -0.002654008, 0.6713633)
bones/55/rotation = Quaternion(-0.3252694, 0.89005524, 0.29597658, 0.11999792)
bones/56/rotation = Quaternion(0.51488185, 0.114150405, -0.114482954, 0.8418789)
bones/57/rotation = Quaternion(0.5920036, 0.038134683, 0.09069914, 0.7999071)
bones/59/position = Vector3(0.0031693697, 0.09872071, 0.014791884)
bones/59/rotation = Quaternion(0.13877109, -0.70491564, 0.15570953, 0.6779315)
bones/60/rotation = Quaternion(0.579984, 0.0462614, -0.030875513, 0.81272703)
bones/61/rotation = Quaternion(0.6827771, -0.0017471355, -0.0025645613, 0.7306201)
bones/62/rotation = Quaternion(-0.004265337, -0.7367137, -0.039478756, 0.6750379)
bones/63/position = Vector3(0.006229555, 0.092641406, -0.023634389)
bones/63/rotation = Quaternion(0.10409552, -0.7196072, 0.18626246, 0.6607844)
bones/64/rotation = Quaternion(0.67069286, 0.016339092, -0.01856633, 0.7413228)
bones/65/rotation = Quaternion(0.6924986, 0.003303659, 0.0040390952, 0.72140044)
bones/66/rotation = Quaternion(-0.06841773, -0.7241101, -0.03323388, 0.6854773)
bones/67/position = Vector3(0.0071536656, 0.06798573, -0.04819838)
bones/68/rotation = Quaternion(0.62995356, 0.029514838, 0.017750997, 0.77586883)
bones/69/rotation = Quaternion(0.8166777, -0.043953452, -0.050986126, 0.57315457)
bones/70/rotation = Quaternion(-0.1290598, -0.72893655, 0.02502581, 0.67183983)
bones/71/position = Vector3(0.15710638, 1.3425967, 0.022954764)
bones/71/rotation = Quaternion(-0.024268983, 0.5527092, 0.83283126, -0.017767055)
bones/72/position = Vector3(-0.08264609, 1.3299136, 0.016308999)
bones/72/rotation = Quaternion(-0.024269098, 0.55271494, 0.83282745, -0.017766884)

[node name="AnimationTree" parent="RigPivot/CharacterRig" index="1"]
parameters/MoveSpace/blend_position = 0.011634

[node name="RightHandBone" parent="RigPivot/CharacterRig" index="2"]
transform = Transform3D(-0.9983139, -0.053450402, -0.02264381, 0.013888558, -0.5986841, 0.80086493, -0.05636298, 0.7992001, 0.5984166, -0.25715294, 1.055997, 0.23434956)

[node name="LeftHandBone" parent="RigPivot/CharacterRig" index="3"]
transform = Transform3D(-0.9368231, -0.34039044, -0.08060289, 0.14357056, -0.58427644, 0.7987543, -0.31898278, 0.7367194, 0.5962336, 0.3086065, 1.0353681, 0.18724777)

[node name="RayAttachment" type="BoneAttachment3D" parent="RigPivot/CharacterRig"]
transform = Transform3D(-0.9983139, -0.053450402, -0.02264381, 0.013888558, -0.5986841, 0.80086493, -0.05636298, 0.7992001, 0.5984166, -0.25715294, 1.055997, 0.23434956)
bone_name = "DEF-hand.R"
bone_idx = 51
use_external_skeleton = true
external_skeleton = NodePath("../Rig/GameRig/Skeleton3D")

[node name="AttackCast" type="RayCast3D" parent="RigPivot/CharacterRig/RayAttachment"]
unique_name_in_owner = true
transform = Transform3D(-3.94858e-08, 4.04238e-08, 1, 0.996195, 0.0871559, 3.58124e-08, -0.0871559, 0.996195, -4.37114e-08, -0.0297705, 0.0799083, 0.0089193)
target_position = Vector3(0, 1, 0)
collision_mask = 8
script = ExtResource("4_gwnis")

[node name="AreaAttack" parent="RigPivot" instance=ExtResource("6_fhl08")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1)
collision_mask = 8

[node name="InteractionCast" type="ShapeCast3D" parent="RigPivot" node_paths=PackedStringArray("ui")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_00tjw")
target_position = Vector3(0, 0, 1)
collision_mask = 2
script = ExtResource("8_x3vf3")
ui = NodePath("../../UserInterface")

[node name="Dash" parent="RigPivot" node_paths=PackedStringArray("player") instance=ExtResource("7_vtle1")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.016743302, 0)
player = NodePath("../..")

[node name="UserInterface" parent="." node_paths=PackedStringArray("player") instance=ExtResource("9_00tjw")]
player = NodePath("..")

[connection signal="defeat" from="HealthComponent" to="." method="_on_health_component_defeat"]
[connection signal="health_changed" from="HealthComponent" to="UserInterface" method="update_health"]
[connection signal="heavy_attack" from="RigPivot/CharacterRig" to="." method="_on_rig_heavy_attack"]

[editable path="RigPivot/CharacterRig"]
[editable path="RigPivot/CharacterRig/Rig"]
