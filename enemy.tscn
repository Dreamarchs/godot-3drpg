[gd_scene load_steps=12 format=3 uid="uid://vfj5ljsw64tc"]

[ext_resource type="Script" uid="uid://dirxuch75tom5" path="res://enemy_script.gd" id="1_4gyqm"]
[ext_resource type="PackedScene" uid="uid://dv7t6uk4jun82" path="res://Assets/3D_Assets/Character/Gear/Tall_Shield.glb" id="2_3yqyl"]
[ext_resource type="PackedScene" uid="uid://vx08dyux7ogm" path="res://Player/rig.tscn" id="2_qi2p4"]
[ext_resource type="PackedScene" uid="uid://co0f73n85y2j0" path="res://area_attack.tscn" id="3_iifgy"]
[ext_resource type="PackedScene" uid="uid://gu3kod7h4spy" path="res://Player/health_component.tscn" id="3_qi2p4"]
[ext_resource type="PackedScene" uid="uid://by7cajw112au6" path="res://Assets/3D_Assets/Character/Gear/Short_Shield.glb" id="3_wujgv"]
[ext_resource type="PackedScene" uid="uid://bns7lh4wq2l4l" path="res://Assets/3D_Assets/Character/Gear/Broken_Sword.glb" id="4_e1ltt"]
[ext_resource type="PackedScene" uid="uid://dj1cbwlis4aty" path="res://Assets/3D_Assets/Character/Gear/Battleaxe.glb" id="5_dxifv"]
[ext_resource type="PackedScene" uid="uid://dxpkhkxv86x0o" path="res://Assets/3D_Assets/Character/Gear/Longsword.glb" id="6_pwjut"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_iifgy"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_qi2p4"]

[node name="enemy" type="Node3D"]

[node name="Enemy" type="CharacterBody3D" parent="."]
collision_layer = 9
script = ExtResource("1_4gyqm")
xp_value = 340
shields = Array[PackedScene]([ExtResource("2_3yqyl"), ExtResource("3_wujgv")])
weapons = Array[PackedScene]([ExtResource("4_e1ltt"), ExtResource("5_dxifv"), ExtResource("6_pwjut")])

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="Enemy"]
avoidance_enabled = true

[node name="CollisionShape3D" type="CollisionShape3D" parent="Enemy"]
shape = SubResource("CapsuleShape3D_iifgy")

[node name="CharacterRig" parent="Enemy" instance=ExtResource("2_qi2p4")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)

[node name="Skeleton3D" parent="Enemy/CharacterRig/Rig/GameRig" index="0"]
bones/0/position = Vector3(0.019980287, 0.890147, -0.019246787)
bones/0/rotation = Quaternion(0.14099017, 1.180185e-07, 1.6807334e-08, 0.99001104)
bones/1/rotation = Quaternion(-0.05287683, 0.0013114496, 0.019336123, 0.998413)
bones/2/position = Vector3(1.8908384e-09, 0.1437375, 6.016432e-09)
bones/2/rotation = Quaternion(0.004817561, -0.0017913008, -0.024441378, 0.9996881)
bones/3/position = Vector3(-8.4687635e-10, 0.1890554, -2.769152e-09)
bones/3/rotation = Quaternion(-0.18266031, 0.0054983874, -0.018092128, 0.98299426)
bones/4/position = Vector3(-3.6444787e-09, 0.08756379, -2.2883526e-09)
bones/4/rotation = Quaternion(0.36020023, -0.006163684, 0.060839217, 0.9308686)
bones/5/rotation = Quaternion(-0.09485658, -2.8790235e-09, -6.282623e-08, 0.995491)
bones/6/rotation = Quaternion(-0.16834095, -0.008605343, -0.03722445, 0.9849882)
bones/7/position = Vector3(0.019980235, 0.8901469, -0.019246707)
bones/7/rotation = Quaternion(-0.078234054, -0.74515295, -0.39450377, 0.53197116)
bones/8/position = Vector3(0.019980257, 0.8901469, -0.019246757)
bones/8/rotation = Quaternion(-0.07823398, 0.745153, 0.3945037, 0.53197116)
bones/9/position = Vector3(0.15112394, 0.95589113, -0.0041887164)
bones/9/rotation = Quaternion(0.99805003, -0.011763266, -0.03405532, 0.05097011)
bones/10/position = Vector3(-2.1640734e-08, 0.2647144, 9.489095e-09)
bones/10/rotation = Quaternion(-3.18357e-09, -0.0054356284, 9.981702e-09, 0.9999852)
bones/11/position = Vector3(-2.4153639e-08, 0.26471448, 1.35308005e-08)
bones/11/rotation = Quaternion(0.49195674, -0.0049934858, 0.004352471, 0.87059456)
bones/12/position = Vector3(2.0031525e-08, 0.22470205, 1.9662938e-08)
bones/12/rotation = Quaternion(1.7263456e-08, -0.0006394086, 2.7793856e-08, 0.9999998)
bones/13/position = Vector3(-1.2672224e-08, 0.22470206, 1.7675275e-08)
bones/13/rotation = Quaternion(-0.7023278, 0.02477472, -0.021429451, 0.7110997)
bones/14/position = Vector3(-1.3747236e-08, 0.13987769, 8.0614804e-10)
bones/14/rotation = Quaternion(-0.00010033617, 0.96746135, -0.25301856, -0.00038247067)
bones/15/position = Vector3(-0.1111634, 0.95589125, -0.0041887593)
bones/15/rotation = Quaternion(0.9448267, -0.010356675, 0.022024944, 0.32666498)
bones/16/position = Vector3(-1.0714597e-08, 0.26441666, -9.50477e-09)
bones/16/rotation = Quaternion(-1.0107066e-08, 0.0039501004, -2.9709077e-10, 0.9999922)
bones/17/position = Vector3(1.01576525e-08, 0.26441678, -2.8785308e-08)
bones/17/rotation = Quaternion(0.56864655, 0.0040296274, -0.0030679046, 0.8225664)
bones/18/position = Vector3(3.726729e-09, 0.22399274, 7.599775e-09)
bones/18/rotation = Quaternion(6.5315664e-10, -0.007359514, 1.2415141e-08, 0.999973)
bones/19/position = Vector3(-2.4997755e-09, 0.22399272, -6.639654e-09)
bones/19/rotation = Quaternion(-0.6766951, -0.028224386, 0.0023201462, 0.7357185)
bones/20/position = Vector3(4.624212e-11, 0.1398778, -8.139072e-09)
bones/20/rotation = Quaternion(-9.955436e-05, 0.9674598, -0.25302488, -0.00038308048)
bones/21/position = Vector3(0.03660695, 1.398507, 0.09087946)
bones/21/rotation = Quaternion(-0.48901272, -0.24493173, -0.42071664, 0.7237904)
bones/22/position = Vector3(0.20153417, 1.4291005, 0.02573902)
bones/22/rotation = Quaternion(-0.06255457, -0.015538724, 0.9871237, -0.14639808)
bones/23/position = Vector3(-5.0730637e-09, 0.14230941, -5.7475766e-08)
bones/23/rotation = Quaternion(7.511772e-08, -0.059109103, 9.873529e-09, 0.99825156)
bones/24/position = Vector3(-5.7129178e-08, 0.14230959, 1.4958015e-08)
bones/24/rotation = Quaternion(0.43072712, -0.06965318, -0.19206321, 0.8790531)
bones/25/position = Vector3(-2.5174879e-08, 0.1259077, 1.4680638e-08)
bones/25/rotation = Quaternion(3.0797818e-07, 0.0350751, -2.2044278e-08, 0.9993847)
bones/26/position = Vector3(2.0000584e-08, 0.12590763, -3.2171963e-09)
bones/26/rotation = Quaternion(-0.011400041, 0.03505146, -0.15287846, 0.9875574)
bones/28/rotation = Quaternion(0.7025832, -0.0009397903, -0.001335505, 0.71159977)
bones/29/rotation = Quaternion(0.7411206, 0.0021826597, 0.0026539832, 0.6713631)
bones/30/rotation = Quaternion(0.32526952, 0.8900551, 0.2959771, -0.11999689)
bones/31/rotation = Quaternion(0.5148822, -0.11414928, 0.11448256, 0.84187895)
bones/32/rotation = Quaternion(0.5920035, -0.038135026, -0.090698734, 0.7999071)
bones/34/position = Vector3(-0.003169373, 0.09872068, 0.014791744)
bones/34/rotation = Quaternion(-0.06747008, 0.71844566, 0.06639644, 0.6891118)
bones/35/rotation = Quaternion(0.5808035, -0.0008918776, -0.0014975058, 0.814042)
bones/36/rotation = Quaternion(0.68277705, 0.0017451891, 0.0025661485, 0.73062027)
bones/37/rotation = Quaternion(-0.0042650797, 0.73671365, 0.039478477, 0.675038)
bones/38/position = Vector3(-0.006229548, 0.09264146, -0.023634413)
bones/38/rotation = Quaternion(-0.10987272, 0.743351, 0.033350505, 0.65897274)
bones/39/rotation = Quaternion(0.63003856, 0.001519644, 0.0023790693, 0.77655876)
bones/40/rotation = Quaternion(0.6526432, -0.003081238, -0.0042106123, 0.7576474)
bones/41/rotation = Quaternion(-0.0684175, 0.72411, 0.033233874, 0.68547744)
bones/42/position = Vector3(-0.0071537, 0.06798579, -0.048198394)
bones/42/rotation = Quaternion(-0.12091299, 0.799109, 0.035892114, 0.5878068)
bones/43/rotation = Quaternion(0.4986928, -0.020270595, -0.025695242, 0.86616075)
bones/44/rotation = Quaternion(0.71538454, 0.035306092, 0.05731429, 0.6954808)
bones/45/rotation = Quaternion(-0.12905948, 0.7289364, -0.025025954, 0.6718401)
bones/46/position = Vector3(0.0002016672, 1.4001399, 0.09149263)
bones/46/rotation = Quaternion(-0.48437795, 0.2540931, 0.372888, 0.74951273)
bones/47/position = Vector3(-0.15772681, 1.4457113, 0.021542478)
bones/47/rotation = Quaternion(-0.12255092, -0.25303096, 0.9295097, 0.23868042)
bones/48/position = Vector3(1.3159109e-09, 0.14342175, 4.387562e-08)
bones/48/rotation = Quaternion(-2.747235e-08, 0.023428163, 2.5789177e-08, 0.9997256)
bones/49/position = Vector3(1.7173278e-08, 0.14342196, 2.3479831e-08)
bones/49/rotation = Quaternion(0.41207623, 0.037503943, 0.2322508, 0.88025355)
bones/50/position = Vector3(-9.280883e-08, 0.12706837, 3.658537e-08)
bones/50/rotation = Quaternion(-9.110267e-08, -0.018551474, -7.020973e-08, 0.999828)
bones/51/position = Vector3(1.3248587e-07, 0.12706849, 7.1819795e-09)
bones/51/rotation = Quaternion(0.12320116, -0.018454293, 0.021971358, 0.9919668)
bones/52/rotation = Quaternion(-0.25630003, 0.8558594, 0.029918559, -0.44824094)
bones/53/rotation = Quaternion(0.694912, 0.1071447, -0.10354832, 0.7034879)
bones/54/rotation = Quaternion(0.7411205, -0.00218271, -0.002654008, 0.67136323)
bones/55/rotation = Quaternion(-0.3252694, 0.8900552, 0.29597658, 0.11999791)
bones/56/rotation = Quaternion(0.5148819, 0.11415041, -0.11448296, 0.84187895)
bones/57/rotation = Quaternion(0.5920036, 0.038134683, 0.09069914, 0.799907)
bones/59/position = Vector3(0.0031693692, 0.098720714, 0.014791885)
bones/59/rotation = Quaternion(0.13877109, -0.7049156, 0.15570955, 0.6779315)
bones/60/rotation = Quaternion(0.579984, 0.046261404, -0.030875517, 0.812727)
bones/61/rotation = Quaternion(0.68277717, -0.0017471352, -0.0025645618, 0.73062015)
bones/62/rotation = Quaternion(-0.004265338, -0.7367138, -0.03947876, 0.67503786)
bones/63/position = Vector3(0.0062295543, 0.0926414, -0.023634389)
bones/63/rotation = Quaternion(0.10409553, -0.7196071, 0.18626244, 0.66078436)
bones/64/rotation = Quaternion(0.67069286, 0.016339092, -0.018566327, 0.7413228)
bones/65/rotation = Quaternion(0.6924986, 0.0033036591, 0.0040390952, 0.72140044)
bones/66/rotation = Quaternion(-0.06841772, -0.7241101, -0.033233877, 0.6854772)
bones/67/position = Vector3(0.0071536656, 0.067985736, -0.048198376)
bones/67/rotation = Quaternion(0.10836411, -0.7682236, 0.1662908, 0.6086354)
bones/68/rotation = Quaternion(0.62995356, 0.029514834, 0.017750993, 0.77586883)
bones/69/rotation = Quaternion(0.81667775, -0.04395346, -0.05098613, 0.57315457)
bones/70/rotation = Quaternion(-0.12905982, -0.72893655, 0.025025807, 0.67183983)
bones/71/position = Vector3(0.13404551, 1.3198658, 0.013529771)
bones/71/rotation = Quaternion(0.018293828, 0.57480717, 0.8179344, 0.015667826)
bones/72/position = Vector3(-0.10596599, 1.3306819, 0.017565416)
bones/72/rotation = Quaternion(0.018293826, 0.5748071, 0.81793445, 0.015667824)

[node name="Knight_02" parent="Enemy/CharacterRig/Rig/GameRig/Skeleton3D" index="1"]
visible = false

[node name="Villager_02" parent="Enemy/CharacterRig/Rig/GameRig/Skeleton3D" index="3"]
visible = true

[node name="AnimationTree" parent="Enemy/CharacterRig" index="1"]
parameters/MoveSpace/blend_position = 0.018219

[node name="RightHandBone" parent="Enemy/CharacterRig" index="2"]
transform = Transform3D(-0.9817252, -0.1702174, -0.08509925, 0.08170195, -0.78085417, 0.6193478, -0.17187397, 0.6010766, 0.78049105, -0.3135539, 0.9982627, -0.03254323)

[node name="LeftHandBone" parent="Enemy/CharacterRig" index="3"]
transform = Transform3D(-0.9114336, -0.40275633, -0.084125556, 0.19453198, -0.60198647, 0.77444786, -0.3625563, 0.68949264, 0.62701917, 0.25693223, 0.9998252, 0.21718787)

[node name="PlayerDetector" type="ShapeCast3D" parent="Enemy/CharacterRig"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_qi2p4")
target_position = Vector3(0, 0, 1)
collision_mask = 4

[node name="AreaAttack" parent="Enemy/CharacterRig" instance=ExtResource("3_iifgy")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1)
collision_mask = 4

[node name="HealthComponent" parent="Enemy" node_paths=PackedStringArray("body") instance=ExtResource("3_qi2p4")]
body = NodePath("..")

[connection signal="velocity_computed" from="Enemy/NavigationAgent3D" to="Enemy" method="_on_navigation_agent_3d_velocity_computed"]
[connection signal="heavy_attack" from="Enemy/CharacterRig" to="Enemy" method="_on_rig_heavy_attack"]
[connection signal="defeat" from="Enemy/HealthComponent" to="Enemy" method="_on_health_component_defeat"]

[editable path="Enemy/CharacterRig"]
[editable path="Enemy/CharacterRig/Rig"]
